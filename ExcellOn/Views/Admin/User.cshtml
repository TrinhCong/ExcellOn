@{ Layout = "~/Views/Shared/_AdminLayout.cshtml"; }

@section AdditionStyles{


}

<div class=" no-margin">
    <div class="content-title">
        <div class="caption">
            <span class="caption-subject font-green-sharp bold uppercase">User Management</span>
        </div>
    </div>
    <div class="content-body">
        <div class="table-toolbar">
            <div class="row">
                <div class="col-md-6">
                    <a class="btn btn-sm btn-success" data-toggle="modal" data-target="#create_modal">
                        Add New
                        <i class="fa fa-plus"></i>
                    </a>
                </div>
            </div>
        </div>
        <table id="product" class="display table table-striped" style="width:100%">
        </table>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="create_modal" data-backdrop="false" tabindex="1" role="dialog" aria-labelledby="create_modal_title" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="create_modal_title">Add New</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="" class="control-label">Full Name<span class="required">*</span></label>
                    <input type="text" class="form-control" name="display_name" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">User Name<span class="required">*</span></label>
                    <input type="text" class="form-control" name="user_name" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">Password<span class="required">*</span></label>
                    <input type="password" class="form-control" name="password" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">Role<span class="required">*</span></label>
                    <select name="role_id"></select>
                </div>
                <div class="form-group">
                    <label for="" class="control-label">phone_number<span class="required">*</span></label>
                    <input type="text" class="form-control" name="phone_number" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">email<span class="required">*</span></label>
                    <input type="text" class="form-control" name="email" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">address<span class="required">*</span></label>
                    <input type="text" class="form-control" name="email" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">email<span class="required">*</span></label>
                    <input type="text" class="form-control" name="email" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">Gender<span class="required">*</span></label>
                    <select name="gender">
                        <option value="1">Male</option>
                        <option value="0">Female</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="" class="control-label">Date Of Birth<span class="required">*</span></label>
                    <input type="date" class="form-control" name="date_of_birth" required />
                </div>
                <div class="form-group">
                    <label for="" class="control-label">Avatar<span class="required">*</span></label>
                    <input type="file" class="form-control" name="avatar_path" required />
                </div>
            </div>
            <div class="modal-footer text-center">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
@section AdditionScripts{

    <script>
        class PageHandler {
            constructor() {
                var instance = this;
                instance.$table = $("#product");
                instance.initTable();
            }
            initTable() {
                var instance = this;
                instance.dtTable = instance.$table.DataTable({
                    "processing": true,
                    "serverSide": false,
                    "filter": true,
                    "datatype": "json",
                    "ajax": {
                        type: "get",
                        contentType: "application/json; charset=utf-8",
                        dataType: 'json',
                        url: "/User/GetAll",
                        //data: function (d) {
                        //    d.search.value = $(".dataTables_filter input").val();
                        //    return JSON.stringify(d);
                        //},
                    },
                    "bStateSave": true, // save datatable state(pagination, sort, etc) in cookie.

                    "lengthMenu": [
                        [5, 15, 20, -1],
                        [5, 15, 20, "Tất cả"] // change per page values here
                    ],
                    // set the initial value
                    "pageLength": 5,

                    columns: [
                        {
                            title: 'Avatar',
                            data: 'avatar_path',
                            render: function (data, type, row, meta) {
                                var avatarSrc = data != "null" ? "/Content/images/no_avatar.png" : "/Content/uploads/avatars/" + data;
                                return '<img src="' + avatarSrc + '" width="30" height="30" />';
                            },

                        },
                        {
                            title: 'Full name',
                            data: 'display_name'
                        },
                        {
                            title: 'User name',
                            data: 'user_name'
                        },
                        {
                            title: 'Email',
                            data: 'email'
                        },
                        {
                            title: 'Role',
                            data: 'role.name'
                        },
                        {
                            title: 'Date of birth',
                            data: 'dob',
                        },
                        {
                            title: 'Address',
                            data: 'address',
                        },
                        {
                            title: 'Gender',
                            data: 'gender',
                            render: function (data, type, row, meta) {
                                return data == 1 ? "Male" : "Female";
                            },
                        },
                        {
                            title: 'Actions',
                            render: function (data, type, row, meta) {
                                return `<a class="btn btn-sm btn-primary view-item" role="button" data-toggle="modal" href="#modal-info" aria-expanded="false">
                                                                    View
                                                                    <i class="fa fa-eye"></i>
                                                                </a>
                                                                <a class="btn btn-sm btn-warning edit-item" role="button" data-toggle="modal" href="#modal-edit" aria-expanded="false">
                                                                    Edit
                                                                    <i class="fa fa-edit"></i>
                                                                </a>
                                                                <a class="btn btn-sm btn-danger delete-item" role="button" aria-expanded="false">
                                                                    Delete
                                                                    <i class="fa fa-trash"></i>
                                                                </a>`;
                            },
                            width: '220px',
                            className: 'text-center'
                        }
                    ],
                    //columnDefs: [
                    //    //{
                    //    // orderable: false,
                    //    // targets: [5]
                    //    //}
                    //],

                    //"initComplete": function (settings, json) {

                    //}
                })
            }

        }

        $(document).ready(function () {
            new PageHandler();
        });
    </script>
}




